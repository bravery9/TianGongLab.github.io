<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">IoT 设备中的认证绕过漏洞分析 | 破壳漏洞挖掘平台</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://poc.qianxin.com/img/poc-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://poc.qianxin.com/img/poc-social-card.jpg"><meta data-rh="true" property="og:url" content="https://poc.qianxin.com/blog/tiangongarticle007"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="IoT 设备中的认证绕过漏洞分析 | 破壳漏洞挖掘平台"><meta data-rh="true" name="description" content="一、前言"><meta data-rh="true" property="og:description" content="一、前言"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-11-22T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="IoT,Authentication Bypass"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://poc.qianxin.com/blog/tiangongarticle007"><link data-rh="true" rel="alternate" href="https://poc.qianxin.com/blog/tiangongarticle007" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://poc.qianxin.com/blog/tiangongarticle007" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://M80RFF4T9F-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="破壳漏洞挖掘平台 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="破壳漏洞挖掘平台 Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="破壳漏洞挖掘平台" href="/opensearch.xml">
<script src="https://www.clarity.ms/tag/k257lj4y58"></script>
<script src="https://hm.baidu.com/hm.js?bd805f6d9db85a795e91b7f0e7038239" async></script><link rel="stylesheet" href="/assets/css/styles.2596aafb.css">
<script src="/assets/js/runtime~main.d7b99991.js" defer="defer"></script>
<script src="/assets/js/main.9cb50580.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://poc.qianxin.com" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo.svg" alt="破壳文档" class="nav-logo-class themedComponent_mlkZ themedComponent--light_NVdE" height="20" width="100"><img src="/img/logo.svg" alt="破壳文档" class="nav-logo-class themedComponent_mlkZ themedComponent--dark_xIcU" height="20" width="100"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link tutorialClass" href="/">文档</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/blog/tags">标签</a><a class="navbar__item navbar__link" href="/blog/archive">归档</a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://poc.qianxin.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">破壳官网<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">所有文章</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle022">Windows hypervisor&amp;内核调试的几种常见/不常见方法</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle021">FortiGate SSLVPN CVE-2024-21762漏洞利用分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle020">Ghidra脚本编写：从IR到反编译C</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle019">关于Linux内核条件竞争的探讨</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle018">WebAssembly安全研究总结</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle017">Terrapin 攻击分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle016">常见 PHP 源码保护与还原</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle015">Server as Client 漏洞模型</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle014">破壳分析：Linksys设备多个0-day漏洞</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle013">ESXi SLP漏洞复现</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle012">从传统到 AI 探讨 Webshell 检测攻防对抗</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle011">人与代码的桥梁-聊聊SAST</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle010">BMC 漏洞实例分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle009">CodeDom 漏洞模式与 SharePoint RCE</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle008">Datacon 2023 漏洞分析赛道赛题二官方题解</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/tiangongarticle007">IoT 设备中的认证绕过漏洞分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle006">Exchange Server(CVE-2023-36439)远程代码执行漏洞分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle005">WAF防护绕过技巧分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle004">伪随机数问题浅析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle003">Windows内核竞态条件漏洞研究</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle002">Microsoft Hyper-V 虚拟 TPM 设备漏洞分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tiangongarticle001">CVE-2023-0179 Linux内核提权</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="一、前言"><header><h1 class="title_f1Hy" itemprop="headline">IoT 设备中的认证绕过漏洞分析</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-11-22T00:00:00.000Z" itemprop="datePublished">2023年11月22日</time> · <!-- -->阅读需 11 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo" src="https://tiangonglab.github.io/img/authors/noir.jpg" alt="noir" itemprop="image"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">noir</span></div><small class="avatar__subtitle" itemprop="description">在代码与防御之间寻找平衡，探索网络安全世界的无尽可能</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="一前言">一、前言<a href="#一前言" class="hash-link" aria-label="一、前言的直接链接" title="一、前言的直接链接">​</a></h2>
<p>在IOT设备中，认证漏洞出现频率较高，能够造成的很大危害。通过认证的绕过，攻击者可以访问到很多敏感接口，甚至可以结合其他漏洞直接获取设备 shell。本文将通过一些设备分析认证过程以及认证绕过。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="二分析">二、分析<a href="#二分析" class="hash-link" aria-label="二、分析的直接链接" title="二、分析的直接链接">​</a></h2>
<p>小设备认证可分为两个部分，一是登录逻辑，设备通常会要求用户输入用户名和密码来进行身份验证；二是对路由的鉴权，其作用是限制用户对不同功能和资源的访问权限。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="一登录">（一）登录<a href="#一登录" class="hash-link" aria-label="（一）登录的直接链接" title="（一）登录的直接链接">​</a></h3>
<p>对于IOT设备中的Web界面，通常在未认证前仅能访问登录界面。为了找到后端登陆逻辑，我们可以借助工具如Burp Suite来进行流量抓包分析。</p>
<p>以某设备A为例，用Burp Suite抓包发现，登陆时请求了<code>/cgi/login</code>路由</p>
<p><img decoding="async" loading="lazy" src="/assets/images/43bd737d-60e0-4525-b5ac-f7fdad85df18-52834cdd7acd8ad4ac9161f3a1d63219.png" width="761" height="301" class="img_ev3q"></p>
<p>在<code>/usr/bin/httpd</code>的ida文件中搜索<code>/cgi/login</code>，可以快速定位到注册CGI的函数。其中<code>http_alias_addEntryByArg</code>的功能是为cgi注册处理函数并设置访问所需要的权限。因此登录的逻辑<code>http_rpm_login</code>中。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/65854689-bdf2-46d2-88bf-346019f9c593-33f8ff987b518663aa85eddbcd439a21.png" width="957" height="459" class="img_ev3q"></p>
<p>有的设备会有专门的cgibin来处理cgi。例如某设备B在cgibin的main函数中使用strcmp比较请求的cgi，如果是<code>authentication_logout.cgi</code>就会进入登录逻辑。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/34decfda-e657-440e-8fcb-fe5d02bbfa68-3226f9dbbcf4c3bf3ec8c8d7b05048d6.png" width="726" height="173" class="img_ev3q"></p>
<p>还有一些设备的路由则是在配置文件中定义，下图是一个nginx+lua的路由器的配置文件，其中定义了在在访问<code>/authenticate</code>时，在<code>content_by_lua</code>阶段加载web模块处理登陆请求。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/ce38e882-6df9-4382-b942-ca6fe3473338-ae67bcda32eb0336d995fce48ae8c920.png" width="548" height="242" class="img_ev3q"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="二鉴权">（二）鉴权<a href="#二鉴权" class="hash-link" aria-label="（二）鉴权的直接链接" title="（二）鉴权的直接链接">​</a></h3>
<p>一般来讲，http对路由都会有访问限制，一般在配置文件或者httpd初始化的时候会定义访问规则。</p>
<p>以某设备A为例，httpd在初始化时调用<code>http_alias_addEntry_ByArg</code>注册CGI处理函数。<code>http_alias_addEntry_ByArg</code>的最后一个参数，表示访问这个路由需要的权限。<code>g_http_author_admin</code>、<code>g_http_author_default</code>、<code>g_http_author_all</code>分别表示访问该CGI需要超级用户权限、普通用户权限、无需权限。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/6fa3f8b1-5d8a-4d47-8fbe-45b7a9c188e5-ed975941e0f14201de6d228ab47bdbb6.png" width="950" height="455" class="img_ev3q"></p>
<p>httpd中每个请求都会通过<code>http_author_hasAuthor</code>鉴权，参数a1是一个全局变量，记录会话相关信息，其中的<code>user_id</code>表示该会话登录的用户，默认为0，在登陆成功后会赋值；a2是包含访问的路由，对应的处理函数和访问所需权限信息的结构体。该函数通过<code>user_id</code>判断<code>a2-&gt;author</code>对应bit是否为1进而确定当前用户是否有权限访问。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/85ce2731-0e84-41e5-93fd-73d66f7971d7-79ed7470c88114fc46193c537b6a3497.png" width="546" height="202" class="img_ev3q"></p>
<p>在某设备C中则是为路由鉴权定义了一个<code>mime_handlers</code>结构体数组，</p>
<p><img decoding="async" loading="lazy" src="/assets/images/5f216007-6f1b-40cc-8c06-9d6a14d19ed7-12f78f317b3ded1c0c0ad743a9d5e84e.png" width="957" height="415" class="img_ev3q"><code>mime_handler</code>定义如下，<code>patten</code>是匹配的模式，<code>handler</code>就是路由对应的处理函数。第四个参数<code>auth</code>表示访问这个路由是否需要鉴权。</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">struct mime_handler </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">char </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">patten</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// **.cgi **.html</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    char </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">mime_type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">handler</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int auth</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>每次httpd接收到请求时会做如下处理：遍历<code>mime_handlers</code>，获取对应的<code>patten</code>字段，调用<code>match_one</code>匹配，匹配成功则获取对应的<code>handler</code>。最后在调用<code>handler</code>前根据<code>auth</code>字段判断是否需要鉴权。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/c2700e5f-1d11-45b5-87db-717715917324-d5c2b804c961e968cc41de3598d60c6c.png" width="522" height="418" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="879" height="98" class="img_ev3q"></p>
<p>这里有一个点，匹配所用到的patten有些是只匹配文件扩展名，例如对于<code>**.cgi</code>，<code>*</code>表明可以匹配0个或多个字符，不管.<code>cgi</code>前有多少个字符都会匹配进去，有可能后续会造成溢出。</p>
<p>在某设备D中，httpd使用strstr来匹配请求的是否是不需要认证的路由，当匹配到白名单路由时设置<code>do_not_need_auth</code>为1，未匹配到白名单则需要认证。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/f9d05b8b-0332-4c06-8245-48fbbac9d24b-547255386a12c9875b24db5fcebb90f8.png" width="1045" height="277" class="img_ev3q"></p>
<p>在某设备E中，在配置文件<code>nginx.conf</code>中定义，<code>access_by_lua</code>阶段加载sessioncontrol模块,重新加载用户信息,获取会话管理器<code>mgr</code>,检查请求并处理认证。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/fc15972e-d080-41a0-aacc-fa140204638a-0ba2d3bf13227568ab67a79200576ba9.png" width="589" height="237" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="三绕过">三、绕过<a href="#三绕过" class="hash-link" aria-label="三、绕过的直接链接" title="三、绕过的直接链接">​</a></h2>
<p>下面通过一些真实漏洞分析认证绕过。</p>
<p><strong>登录功能对于用户名/密码处理不恰当</strong></p>
<p>最简单的绕过方式是首先登陆时有默认密码，有的是硬编码在程序中，或者调试可以发现。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="案例一cve-2020-8864">案例一：CVE-2020-8864<a href="#案例一cve-2020-8864" class="hash-link" aria-label="案例一：CVE-2020-8864的直接链接" title="案例一：CVE-2020-8864的直接链接">​</a></h3>
<p>D-LINK DIR-882设备，在登陆时密码比较的逻辑中，28行获取我们输入的密码，第47行会调用<code>strlen</code>获得我们输入的密码的长度，之后使用<code>strncmp</code>进行比较，如果我们输入空密码，strncmp的第三个参数为0，返回值一定是0，表示比较成功，即可绕过认证。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/400905a7-3c49-4f49-9641-b9a6a9d77896-59d0aa385b682a8e176d6006cb8bdf53.png" width="811" height="470" class="img_ev3q"></p>
<p>漏洞修补：比较前判断用户输入密码是否为空</p>
<p><strong>会话管理存在问题，控制 Cookie 值绕过会话检查。</strong></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="案例二cve-2021-32030">案例二：CVE-2021-32030<a href="#案例二cve-2021-32030" class="hash-link" aria-label="案例二：CVE-2021-32030的直接链接" title="案例二：CVE-2021-32030的直接链接">​</a></h3>
<p>ASUS RT-AX56U设备，需要鉴权的接口都会从请求获取cookie参数，之后传入auth函数。auth函数中，从nvram获取ifttt_token。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/4b996b8c-f125-41c0-ba6a-07ca6df988c4-274b033d8d81086ca4a8274a15de459b.png" width="532" height="274" class="img_ev3q"></p>
<p>在默认情况IFTTT没有开启，ifttt_token为空，通过请求中传入空的cookie可绕过认证。</p>
<p>漏洞修补：比较cookie前判断cookie是否为空</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="案例三cve-2021-35973">案例三：CVE-2021-35973<a href="#案例三cve-2021-35973" class="hash-link" aria-label="案例三：CVE-2021-35973的直接链接" title="案例三：CVE-2021-35973的直接链接">​</a></h3>
<p>Netgear wac104设备，在访问需要认证的cgi时会对session进行认证，在第42、49行首先从POST请求中获取id和sp字段的值，之后第53行snprintf将/tmp/SessionFile和sp_from_post拼接在一起作为get_id_from_session_file的参数。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/99b7f573-3462-4225-8f34-544258b9508d-3399af4c3d3f8724487cfabb1801819f.png" width="872" height="421" class="img_ev3q"><code>get_id_from_session_file</code>中，首先返回值赋值为0，打开<code>session_file</code>， 从<code>sesseion_file</code>读取id，如果文件不存在则直接接返回初始化为0的id。<code>session_file</code>用户可控的，通过构造<code>id=0&amp;sp=AAA</code>这种，把<code>sessionfile</code>设置成一定不存在的文件路径，那么返回值就一定是0，可绕过<code>id_from_post == id_from_session_file</code>的检查。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/75c68998-8fa4-4bf4-acd6-2143ff210a00-c224fa74c57a0266d9080ac2dd5539e0.png" width="524" height="290" class="img_ev3q"></p>
<p>漏洞修补：判断session文件是否存在</p>
<p><strong>对用户访问的资源路径处理不恰当，访问到敏感接口。</strong></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="案例四cve-2021-35973">案例四：CVE-2021-35973<a href="#案例四cve-2021-35973" class="hash-link" aria-label="案例四：CVE-2021-35973的直接链接" title="案例四：CVE-2021-35973的直接链接">​</a></h3>
<p>Netgear wac104设备，httpd中data段存放着无需认证的页面</p>
<p><img decoding="async" loading="lazy" src="/assets/images/5d9ea872-f144-4f70-8a27-3060837c306c-7a4cc7dd35175db073b0e1f0810be6a8.png" width="713" height="189" class="img_ev3q"></p>
<p>在判断是否需要路由认证时使用<code>strstr</code>来匹配，如果匹配到了就设置<code>do_not_need_auth</code>为1，表示请求的页面不需要认证。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="517" height="113" class="img_ev3q"></p>
<p>绕过方式是使用<code>/AAA%00currentsetting.htm</code>请求，<code>AAA</code>是需要认证的页面，因为匹配使用的是<code>strstr</code>，可以成功匹配。在成功之后整个url会解码，%00截断，实际访问<code>/AAA</code>页面，从而无需认证也能访问需要认证的页面。</p>
<p>漏洞修补：url解码前检测%00</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="案例五cve-2021-20090">案例五：CVE-2021-20090<a href="#案例五cve-2021-20090" class="hash-link" aria-label="案例五：CVE-2021-20090的直接链接" title="案例五：CVE-2021-20090的直接链接">​</a></h3>
<p>同样有一个白名单，</p>
<p><img decoding="async" loading="lazy" src="/assets/images/39bcb58b-316b-46b9-9fd3-f596d1772d6e-8c25ac86666fae1833e38c07fbc3c3c2.png" width="679" height="207" class="img_ev3q"></p>
<p>匹配时使用<code>strncmp</code>，n是白名单中字符串的长度，只匹配前几个字符，配合路径穿越，使用<code>/images/..%2finfo.html</code>可绕过认证访问<code>info.html</code>页面。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/684ac624-8737-4fef-9ac8-7cb41e65bdf4-f82e2f6a38214260aa855c1b3aada338.png" width="541" height="401" class="img_ev3q"></p>
<p><strong>暴露了敏感接口或接口权限设置不当</strong></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="案例六">案例六<a href="#案例六" class="hash-link" aria-label="案例六的直接链接" title="案例六的直接链接">​</a></h3>
<p>还是某设备A，<code>/cgi/setpwd</code>的功能是重置密码，但是设置了<code>g_http_author_all</code>无需授权访问，导致无需认证重置密码。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/c9d6921a-fef0-452d-832d-89b6761814ff-399dfc14b55d07c7f80e9b168dc0daf4.png" width="871" height="413" class="img_ev3q"></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="案例七">案例七<a href="#案 例七" class="hash-link" aria-label="案例七的直接链接" title="案例七的直接链接">​</a></h3>
<p>MI router ac2600设备，nginx的配置文件中，第12行变量<code>$http_host</code>可以包含不受信任的用户输入，导致存在CSRF攻击。</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> listen </span><span class="token number" style="color:#36acaa">8197</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> # resolver </span><span class="token number" style="color:#36acaa">8.8</span><span class="token number" style="color:#36acaa">.8</span><span class="token number" style="color:#36acaa">.8</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> resolver </span><span class="token number" style="color:#36acaa">127.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token number" style="color:#36acaa">.1</span><span class="token plain"> valid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">30s</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> log_format log_subfilter </span><span class="token string" style="color:#e3116c">&#x27;&quot;$server_addr&quot;\t&quot;$host&quot;\t&quot;$remote_addr&quot;\t&quot;$time_local&quot;\t&quot;$request_method $request_uri&quot;\t&quot;$status&quot;\t&quot;$request_length&quot;\t&quot;$bytes_sent&quot;\t&quot;$request_time&quot;\t&quot;$sent_http_ MiCGI_Cache_Status&quot;\t&quot;$upstream_addr&quot;\t&quot;$upstream_response_time&quot;\t&quot;$http_referer&quot;\t&quot;$http_user_agent&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> access_log off</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #access_log </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">userdisk</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">proxy_8197</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">log</span><span class="token plain">  log_subfilter</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #error_log </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">userdisk</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sysapihttpd</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">log</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">log</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">location</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header </span><span class="token maybe-class-name">Accept</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Encoding</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_pass http</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">$http_host$request_uri</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    add_header  </span><span class="token constant" style="color:#36acaa">XQ</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Mark</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;subfilter&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_connect_timeout </span><span class="token number" style="color:#36acaa">600</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token spread operator" style="color:#393A34">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在<code>\usr\lib\lua\luci\dispatcher</code>关于鉴权的判断中，当<code>ip == &quot;127.0.0.1&quot; and host == &quot;localhost&quot;</code>时可绕过鉴权。</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">local ip </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;REMOTE_ADDR&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local host </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getenv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;HTTP_HOST&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local isremote </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ip </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><span class="token plain"> and host </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">_sdkFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">track</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> and not isremote then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local sdkutil </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;xiaoqiang.util.XQSDKUtil&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> not sdkutil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">checkPermission</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">getremotemac</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        luci</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string-property property" style="color:#36acaa">&quot;code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1500</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string-property property" style="color:#36acaa">&quot;msg&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Permission denied&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在<code>/usr/lib/lua/luci/controller/api/xqsystem.lua</code>中的<code>renewToken</code>接口,可以泄露token，从而绕过认 证。</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">entry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;api&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;xqsystem&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;renew_token&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">call</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;renewToken&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">136</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">renewToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local datatypes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;luci.cbi.datatypes&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local sauth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> require </span><span class="token string" style="color:#e3116c">&quot;luci.sauth&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local ip </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">LuciHttp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">formvalue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ip&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> ip and not datatypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">ipaddr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ip</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ip </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    local session </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sauth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">available</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ip</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> session and session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">token</span><span class="token plain"> then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;token&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        local token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> luci</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">uniqueid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sauth</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            user</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;admin&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            token</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ltype</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ip</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ip</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            secret</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">luci</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">uniqueid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;token&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;code&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">LuciHttp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">write_json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="四总结">四、总结<a href="#四总结" class="hash-link" aria-label="四、总结的直接链接" title="四、总结的直接链接">​</a></h2>
<p>借助此文简单分析总结了IOT的一些认证绕过，可以看到这些漏洞更多的是缺少对特定条件的检查，从而攻击者可以利用这些特定条件绕过检查。通过本文能够更好地帮助大家分析IOT设备中的认证逻辑，希望在IOT漏洞挖掘中能够帮助到大家。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="五参考">五、参考<a href="#五参考" class="hash-link" aria-label="五、参考的直接链接" title="五、参考的直接链接">​</a></h2>
<p><a href="https://www.anquanke.com/post/id/247597" target="_blank" rel="noopener noreferrer">https://www.anquanke.com/post/id/247597</a></p>
<p><a href="https://paper.seebug.org/1640/" target="_blank" rel="noopener noreferrer">CVE-2021-35973：Netgear wac104 身份认证绕过</a></p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/io-t">IoT</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/authentication-bypass">Authentication Bypass</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/TianGongLab/poc_docs/tree/main/blog/2023-11-22-analysis-of-authentication-bypass-vulnerabilities-in-IoT-devices/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/tiangongarticle008"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">Datacon 2023 漏洞分析赛道赛题二官方题解</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/tiangongarticle006"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">Exchange Server(CVE-2023-36439)远程代码执行漏洞分析</div></a></nav><div style="margin-top:20px"></div></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一前言" class="table-of-contents__link toc-highlight">一、前言</a></li><li><a href="#二分析" class="table-of-contents__link toc-highlight">二、分析</a><ul><li><a href="#一登录" class="table-of-contents__link toc-highlight">（一）登录</a></li><li><a href="#二鉴权" class="table-of-contents__link toc-highlight">（二）鉴权</a></li></ul></li><li><a href="#三绕过" class="table-of-contents__link toc-highlight">三、绕过</a><ul><li><a href="#案例一cve-2020-8864" class="table-of-contents__link toc-highlight">案例一：CVE-2020-8864</a></li><li><a href="#案例二cve-2021-32030" class="table-of-contents__link toc-highlight">案例二：CVE-2021-32030</a></li><li><a href="#案例三cve-2021-35973" class="table-of-contents__link toc-highlight">案例三：CVE-2021-35973</a></li><li><a href="#案例四cve-2021-35973" class="table-of-contents__link toc-highlight">案例四：CVE-2021-35973</a></li><li><a href="#案例五cve-2021-20090" class="table-of-contents__link toc-highlight">案例五：CVE-2021-20090</a></li><li><a href="#案例六" class="table-of-contents__link toc-highlight">案例六</a></li><li><a href="#案例七" class="table-of-contents__link toc-highlight">案例七</a></li></ul></li><li><a href="#四总结" class="table-of-contents__link toc-highlight">四、总结</a></li><li><a href="#五参考" class="table-of-contents__link toc-highlight">五、参考</a></li></ul></div></div></div></div></div></div>
</body>
</html>